<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promillerechner Schweiz - Blutalkohol berechnen | wieviel.ch</title>
    <link rel="icon" type="image/svg+xml" href="../../favicon.svg">
    <meta name="description" content="Berechnen Sie Ihren Blutalkoholwert (BAK) mit dem Schweizer Promillerechner. Erfahren Sie, wann Sie wieder fahrt√ºchtig sind.">
    <meta name="keywords" content="Promillerechner, Blutalkohol, BAK, Alkohol, Schweiz, Fahrt√ºchtigkeit, Widmark">
    <meta name="author" content="Durchblick Consultancy BV">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://wieviel.ch/promille/de/">
    <meta property="og:title" content="Promillerechner Schweiz - Blutalkohol berechnen">
    <meta property="og:description" content="Berechnen Sie Ihren Blutalkoholwert und erfahren Sie, wann Sie wieder fahrt√ºchtig sind.">
    <meta property="og:locale" content="de_CH">

    <!-- Canonical & Language -->
    <link rel="canonical" href="https://wieviel.ch/promille/de/">
    <link rel="alternate" hreflang="de" href="https://wieviel.ch/promille/de/">
    <link rel="alternate" hreflang="fr" href="https://wieviel.ch/promille/fr/">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Economica:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="../../css/styles.css">
</head>
<body>
    <div class="container">
        <div class="header-row">
            <button type="button" class="dark-mode-toggle" aria-label="Dunkelmodus umschalten" onclick="DarkMode.toggle()">
                <i class="fas fa-moon"></i>
            </button>
            <div class="language-switcher">
                <a href="../de/" class="lang-btn active">DE</a>
                <a href="../fr/" class="lang-btn">FR</a>
            </div>
        </div>

        <h1><span class="title-icon">üç∫</span>Promillerechner Schweiz</h1>

        <nav class="tool-nav">
            <a href="../../">Alle Tools</a>
            <a href="../de/" class="active">Promillerechner</a>
        </nav>

        <div class="steps-container">
            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-user"></i>
                    <div class="step-number">1</div>
                </div>
                <div class="step-content">
                    <h3>Pers√∂nliche Daten</h3>
                    <p>Geschlecht und K√∂rpergewicht beeinflussen die Alkoholaufnahme.</p>
                </div>
            </div>

            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-beer-mug-empty"></i>
                    <div class="step-number">2</div>
                </div>
                <div class="step-content">
                    <h3>Getr√§nke eingeben</h3>
                    <p>W√§hlen Sie Art und Menge der konsumierten Getr√§nke.</p>
                </div>
            </div>

            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-clock"></i>
                    <div class="step-number">3</div>
                </div>
                <div class="step-content">
                    <h3>Ergebnis</h3>
                    <p>Sehen Sie Ihren gesch√§tzten Blutalkoholwert und Abbauzeit.</p>
                </div>
            </div>
        </div>

        <div class="calculator-card">
            <form id="promilleForm">
                <!-- Gender Selection -->
                <div class="form-group">
                    <label class="required">Geschlecht</label>
                    <div class="gender-selection">
                        <button type="button" class="gender-btn active" data-gender="male" onclick="selectGender('male')">
                            <i class="fas fa-mars"></i>
                            <span>Mann</span>
                        </button>
                        <button type="button" class="gender-btn" data-gender="female" onclick="selectGender('female')">
                            <i class="fas fa-venus"></i>
                            <span>Frau</span>
                        </button>
                    </div>
                </div>

                <!-- Weight Slider -->
                <div class="form-group">
                    <div class="slider-group">
                        <div class="slider-header">
                            <label class="required">K√∂rpergewicht</label>
                            <span class="slider-value" id="weightValue">75 kg</span>
                        </div>
                        <input type="range" id="weight" min="40" max="150" value="75" oninput="updateWeight(this.value)">
                    </div>
                </div>

                <!-- Drinks Selection -->
                <div class="form-group">
                    <label class="required">Was haben Sie getrunken?</label>
                    <div class="drinks-grid">
                        <div class="drink-card" id="drink-beer">
                            <div class="drink-icon">üç∫</div>
                            <div class="drink-name">Bier</div>
                            <div class="drink-info">3dl, 5%</div>
                            <div class="drink-counter">
                                <button type="button" onclick="changeDrink('beer', -1)" disabled>‚àí</button>
                                <span class="drink-count" id="count-beer">0</span>
                                <button type="button" onclick="changeDrink('beer', 1)">+</button>
                            </div>
                        </div>

                        <div class="drink-card" id="drink-beer-large">
                            <div class="drink-icon">üçª</div>
                            <div class="drink-name">Bier gross</div>
                            <div class="drink-info">5dl, 5%</div>
                            <div class="drink-counter">
                                <button type="button" onclick="changeDrink('beer-large', -1)" disabled>‚àí</button>
                                <span class="drink-count" id="count-beer-large">0</span>
                                <button type="button" onclick="changeDrink('beer-large', 1)">+</button>
                            </div>
                        </div>

                        <div class="drink-card" id="drink-wine">
                            <div class="drink-icon">üç∑</div>
                            <div class="drink-name">Wein</div>
                            <div class="drink-info">1dl, 12%</div>
                            <div class="drink-counter">
                                <button type="button" onclick="changeDrink('wine', -1)" disabled>‚àí</button>
                                <span class="drink-count" id="count-wine">0</span>
                                <button type="button" onclick="changeDrink('wine', 1)">+</button>
                            </div>
                        </div>

                        <div class="drink-card" id="drink-wine-glass">
                            <div class="drink-icon">ü•Ç</div>
                            <div class="drink-name">Weinglas</div>
                            <div class="drink-info">1.5dl, 12%</div>
                            <div class="drink-counter">
                                <button type="button" onclick="changeDrink('wine-glass', -1)" disabled>‚àí</button>
                                <span class="drink-count" id="count-wine-glass">0</span>
                                <button type="button" onclick="changeDrink('wine-glass', 1)">+</button>
                            </div>
                        </div>

                        <div class="drink-card" id="drink-shot">
                            <div class="drink-icon">ü•É</div>
                            <div class="drink-name">Schnaps</div>
                            <div class="drink-info">4cl, 40%</div>
                            <div class="drink-counter">
                                <button type="button" onclick="changeDrink('shot', -1)" disabled>‚àí</button>
                                <span class="drink-count" id="count-shot">0</span>
                                <button type="button" onclick="changeDrink('shot', 1)">+</button>
                            </div>
                        </div>

                        <div class="drink-card" id="drink-cocktail">
                            <div class="drink-icon">üç∏</div>
                            <div class="drink-name">Cocktail</div>
                            <div class="drink-info">~4cl Alk.</div>
                            <div class="drink-counter">
                                <button type="button" onclick="changeDrink('cocktail', -1)" disabled>‚àí</button>
                                <span class="drink-count" id="count-cocktail">0</span>
                                <button type="button" onclick="changeDrink('cocktail', 1)">+</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Time inputs -->
                <div class="form-group">
                    <label>Trinkzeitraum</label>
                    <div class="time-inputs">
                        <div>
                            <label for="startTime">Beginn</label>
                            <input type="time" id="startTime" value="20:00">
                        </div>
                        <div>
                            <label for="endTime">Ende / Jetzt</label>
                            <input type="time" id="endTime">
                        </div>
                    </div>
                </div>

                <div class="warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Wichtig:</strong> Dieser Rechner liefert nur Sch√§tzwerte. Die tats√§chliche BAK h√§ngt von vielen individuellen Faktoren ab. Im Zweifelsfall: Nicht fahren!
                </div>

                <div class="warning" id="drinkWarning" style="display: none; background-color: #f8d7da; border-left-color: #dc3545;">
                    <i class="fas fa-ban" style="color: #dc3545;"></i>
                    <strong>Empfehlung:</strong> Wer Alkohol getrunken hat, sollte grunds√§tzlich nicht mehr Auto fahren ‚Äì unabh√§ngig vom berechneten Promillewert.
                </div>

                <button type="submit">Promille berechnen</button>
            </form>

            <div id="result" class="result" style="display: none;">
                <div class="bac-display">
                    <div class="bac-value" id="bacValue">0.00<span class="bac-unit">‚Ä∞</span></div>
                    <div class="bac-status" id="bacStatus">N√ºchtern</div>
                </div>
                <div class="result-summary" id="resultSummary"></div>
                <div class="sobriety-timeline" id="sobrietyTimeline"></div>
            </div>
        </div>

        <div class="info-cards-container">
            <div class="info-step-card highlight">
                <div class="step-icon">
                    <i class="fas fa-gavel"></i>
                </div>
                <div class="step-content">
                    <h3>Promillegrenzen Schweiz</h3>
                    <div class="legal-limit-card standard">
                        <div class="legal-limit-value">0.5‚Ä∞</div>
                        <div>
                            <strong>Normale Fahrer</strong><br>
                            <small>Mit unbefristetem F√ºhrerschein</small>
                        </div>
                    </div>
                    <div class="legal-limit-card strict">
                        <div class="legal-limit-value">0.1‚Ä∞</div>
                        <div>
                            <strong>Neulenker & Berufschauffeure</strong><br>
                            <small>Praktisch Null-Toleranz</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-hourglass-half"></i>
                </div>
                <div class="step-content">
                    <h3>Alkoholabbau</h3>
                    <p>Der K√∂rper baut Alkohol mit etwa <strong>0.1 ‚Äì 0.15‚Ä∞ pro Stunde</strong> ab.</p>
                    <p>Dieser Abbau ist konstant und kann nicht beschleunigt werden ‚Äì weder durch Kaffee, Duschen noch frische Luft.</p>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-calculator"></i>
                </div>
                <div class="step-content">
                    <h3>Widmark-Formel</h3>
                    <p>Die Berechnung basiert auf der wissenschaftlichen Widmark-Formel von 1932:</p>
                    <p><strong>BAK = A √∑ (m √ó r)</strong></p>
                    <p><small>A = Alkohol in Gramm, m = K√∂rpergewicht, r = Verteilungsfaktor</small></p>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-exclamation-circle"></i>
                </div>
                <div class="step-content">
                    <h3>Einflussfaktoren</h3>
                    <p>Die tats√§chliche BAK variiert je nach:</p>
                    <ul>
                        <li>Mageninhalt (n√ºchtern = schnellere Aufnahme)</li>
                        <li>Trinkgeschwindigkeit</li>
                        <li>K√∂rperzusammensetzung</li>
                        <li>Allgemeiner Gesundheitszustand</li>
                        <li>Medikamenteneinnahme</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="law-section">
            <h2>Strafen bei Alkohol am Steuer</h2>
            <p class="law-subtitle">Schweiz ‚Äì Art. 91 SVG</p>

            <div class="law-card">
                <div class="law-header">
                    <h3>0.5 ‚Äì 0.79‚Ä∞</h3>
                </div>
                <div class="law-content">
                    <p><strong>Verwarnung</strong> und Busse (ab CHF 600)</p>
                    <p>Erstmaliges Vergehen bei sonst einwandfreiem Verhalten.</p>
                </div>
            </div>

            <div class="law-card">
                <div class="law-header">
                    <h3>0.8‚Ä∞ und mehr</h3>
                </div>
                <div class="law-content">
                    <p><strong>F√ºhrerausweisentzug</strong> mindestens 3 Monate</p>
                    <p>Geldstrafe oder Freiheitsstrafe bis 3 Jahre</p>
                </div>
            </div>

            <div class="law-card">
                <div class="law-header">
                    <h3>1.6‚Ä∞ und mehr</h3>
                </div>
                <div class="law-content">
                    <p><strong>F√ºhrerausweisentzug</strong> mindestens 2 Jahre</p>
                    <p>Obligatorische verkehrsmedizinische Untersuchung</p>
                    <p>Eintrag im Strafregister</p>
                </div>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <p><a href="https://durchblick.nl" target="_blank" rel="noopener">Durchblick Consultancy BV</a></p>
            <p class="footer-disclaimer">Dieser Rechner dient nur zur Orientierung und ersetzt keine Blutalkoholmessung.</p>
            <p class="footer-privacy">Alle Berechnungen erfolgen lokal in Ihrem Browser. Es werden keine Daten gespeichert.</p>
        </div>
    </footer>

    <script>
        // State
        let state = {
            gender: 'male',
            weight: 75,
            drinks: {
                'beer': 0,
                'beer-large': 0,
                'wine': 0,
                'wine-glass': 0,
                'shot': 0,
                'cocktail': 0
            }
        };

        // Alcohol content in grams per drink
        const drinkAlcohol = {
            'beer': 12,        // 300ml √ó 5% √ó 0.8
            'beer-large': 20,  // 500ml √ó 5% √ó 0.8
            'wine': 9.6,       // 100ml √ó 12% √ó 0.8
            'wine-glass': 14.4,// 150ml √ó 12% √ó 0.8
            'shot': 12.8,      // 40ml √ó 40% √ó 0.8 (CH Standard: 4cl)
            'cocktail': 12.8   // ~40ml √ó 40% √ó 0.8
        };

        // Reduction factors
        const reductionFactor = {
            'male': 0.68,
            'female': 0.55
        };

        // Functions
        function selectGender(gender) {
            state.gender = gender;
            document.querySelectorAll('.gender-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.gender === gender);
            });
            calculateBAC();
        }

        function updateWeight(value) {
            state.weight = parseInt(value);
            document.getElementById('weightValue').textContent = value + ' kg';
            calculateBAC();
        }

        function changeDrink(drink, delta) {
            state.drinks[drink] = Math.max(0, state.drinks[drink] + delta);
            document.getElementById('count-' + drink).textContent = state.drinks[drink];

            // Update card styling
            const card = document.getElementById('drink-' + drink);
            card.classList.toggle('has-drinks', state.drinks[drink] > 0);

            // Update minus button
            const minusBtn = card.querySelector('button:first-of-type');
            minusBtn.disabled = state.drinks[drink] === 0;

            // Show warning if any drinks
            const totalDrinks = Object.values(state.drinks).reduce((a, b) => a + b, 0);
            document.getElementById('drinkWarning').style.display = totalDrinks > 0 ? 'block' : 'none';

            calculateBAC();
        }

        function calculateBAC() {
            // Calculate total alcohol
            let totalAlcohol = 0;
            for (const [drink, count] of Object.entries(state.drinks)) {
                totalAlcohol += drinkAlcohol[drink] * count;
            }

            // Get time elapsed
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;
            let hoursElapsed = 0;

            if (startTime && endTime) {
                const start = new Date(`2000-01-01T${startTime}`);
                let end = new Date(`2000-01-01T${endTime}`);
                if (end < start) end.setDate(end.getDate() + 1);
                hoursElapsed = (end - start) / (1000 * 60 * 60);
            }

            // Widmark formula with resorption deficit (10-30%, we use 20%)
            const resorptionDeficit = 0.8;
            const r = reductionFactor[state.gender];
            const eliminationRate = 0.15; // ‚Ä∞ per hour

            // Peak BAC
            let bac = (totalAlcohol * resorptionDeficit) / (state.weight * r);

            // Subtract elimination
            bac = Math.max(0, bac - (hoursElapsed * eliminationRate));

            return {
                bac: bac,
                totalAlcohol: totalAlcohol,
                hoursElapsed: hoursElapsed
            };
        }

        function getStatusClass(bac) {
            if (bac < 0.3) return { class: 'safe', text: 'Wahrscheinlich fahrt√ºchtig' };
            if (bac < 0.5) return { class: 'caution', text: 'Vorsicht ‚Äì nahe am Limit' };
            if (bac < 0.8) return { class: 'danger', text: 'Nicht fahrt√ºchtig!' };
            return { class: 'critical', text: 'Stark alkoholisiert!' };
        }

        function formatTime(date) {
            return date.toLocaleTimeString('de-CH', { hour: '2-digit', minute: '2-digit' });
        }

        function displayResult(result) {
            const { bac, totalAlcohol, hoursElapsed } = result;
            const status = getStatusClass(bac);

            // BAC Display
            document.getElementById('bacValue').innerHTML = bac.toFixed(2) + '<span class="bac-unit">‚Ä∞</span>';
            document.getElementById('bacValue').className = 'bac-value bac-' + status.class;

            const statusEl = document.getElementById('bacStatus');
            statusEl.textContent = status.text;
            statusEl.className = 'bac-status ' + status.class;

            // Summary
            let summaryHTML = `
                <h3>Zusammenfassung</h3>
                <p><strong>Gesamtalkohol:</strong> ${totalAlcohol.toFixed(1)}g reiner Alkohol</p>
                <p><strong>Gesch√§tzte BAK:</strong> ${bac.toFixed(2)}‚Ä∞</p>
            `;

            if (bac >= 0.5) {
                const hoursTo05 = (bac - 0.5) / 0.15;
                const hoursTo0 = bac / 0.15;

                const now = new Date();
                const timeTo05 = new Date(now.getTime() + hoursTo05 * 60 * 60 * 1000);
                const timeTo0 = new Date(now.getTime() + hoursTo0 * 60 * 60 * 1000);

                summaryHTML += `
                    <p><strong>Unter 0.5‚Ä∞:</strong> ca. ${formatTime(timeTo05)} (in ${hoursTo05.toFixed(1)}h)</p>
                    <p><strong>Vollst√§ndig n√ºchtern:</strong> ca. ${formatTime(timeTo0)} (in ${hoursTo0.toFixed(1)}h)</p>
                `;
            } else if (bac > 0) {
                const hoursTo0 = bac / 0.15;
                const now = new Date();
                const timeTo0 = new Date(now.getTime() + hoursTo0 * 60 * 60 * 1000);
                summaryHTML += `
                    <p><strong>Vollst√§ndig n√ºchtern:</strong> ca. ${formatTime(timeTo0)} (in ${hoursTo0.toFixed(1)}h)</p>
                `;
            }

            document.getElementById('resultSummary').innerHTML = summaryHTML;

            // Timeline
            if (bac > 0) {
                let timelineHTML = '<h4>Abbau-Prognose</h4>';
                const now = new Date();
                let currentBAC = bac;

                for (let h = 0; currentBAC > 0 && h <= 12; h++) {
                    const time = new Date(now.getTime() + h * 60 * 60 * 1000);
                    const bacAtTime = Math.max(0, bac - (h * 0.15));
                    const bacStatus = getStatusClass(bacAtTime);

                    timelineHTML += `
                        <div class="timeline-item">
                            <span class="timeline-time">${formatTime(time)}</span>
                            <span class="timeline-bac bac-${bacStatus.class}">${bacAtTime.toFixed(2)}‚Ä∞</span>
                            <span class="timeline-note">${h === 0 ? 'Jetzt' : `+${h}h`}</span>
                        </div>
                    `;
                    currentBAC = bacAtTime;
                    if (bacAtTime === 0) break;
                }

                document.getElementById('sobrietyTimeline').innerHTML = timelineHTML;
                document.getElementById('sobrietyTimeline').style.display = 'block';
            } else {
                document.getElementById('sobrietyTimeline').style.display = 'none';
            }

            document.getElementById('result').style.display = 'block';
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        }

        // Form submit
        document.getElementById('promilleForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const result = calculateBAC();
            displayResult(result);
        });

        // Set current time as end time
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            document.getElementById('endTime').value =
                now.getHours().toString().padStart(2, '0') + ':' +
                now.getMinutes().toString().padStart(2, '0');
        });

        // Dark Mode
        const DarkMode = {
            STORAGE_KEY: 'darkMode',
            init() {
                const saved = localStorage.getItem(this.STORAGE_KEY);
                if (saved === 'true' || (saved === null && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                    this.enable(false);
                }
                this.updateButton();
            },
            enable(save = true) {
                document.documentElement.setAttribute('data-theme', 'dark');
                if (save) localStorage.setItem(this.STORAGE_KEY, 'true');
                this.updateButton();
            },
            disable(save = true) {
                document.documentElement.removeAttribute('data-theme');
                if (save) localStorage.setItem(this.STORAGE_KEY, 'false');
                this.updateButton();
            },
            toggle() {
                document.documentElement.getAttribute('data-theme') === 'dark' ? this.disable() : this.enable();
            },
            updateButton() {
                const btn = document.querySelector('.dark-mode-toggle i');
                if (btn) {
                    btn.className = document.documentElement.getAttribute('data-theme') === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
                }
            }
        };
        DarkMode.init();
    </script>
</body>
</html>
