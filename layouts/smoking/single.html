{{ partial "head.html" . }}
{{ partial "header.html" . }}

<div class="container">
    {{ partial "page-header.html" . }}

    <div class="steps-container">
        <div class="step-card">
            <div class="step-icon">
                <i class="fas fa-smoking"></i>
                <div class="step-number">1</div>
            </div>
            <div class="step-content">
                <h3>{{ i18n "smoking.step1Title" }}</h3>
                <p>{{ i18n "smoking.step1Desc" }}</p>
            </div>
        </div>

        <div class="step-card">
            <div class="step-icon">
                <i class="fas fa-calculator"></i>
                <div class="step-number">2</div>
            </div>
            <div class="step-content">
                <h3>{{ i18n "smoking.step2Title" }}</h3>
                <p>{{ i18n "smoking.step2Desc" }}</p>
            </div>
        </div>

        <div class="step-card">
            <div class="step-icon">
                <i class="fas fa-piggy-bank"></i>
                <div class="step-number">3</div>
            </div>
            <div class="step-content">
                <h3>{{ i18n "smoking.step3Title" }}</h3>
                <p>{{ i18n "smoking.step3Desc" }}</p>
            </div>
        </div>
    </div>

    <div class="calculator-card">
        <h3 style="margin-top: 0;"><i class="fas fa-smoking"></i> {{ i18n "smoking.yourConsumption" }}</h3>

        <div class="smoking-input">
            <div class="smoking-icon">ðŸš¬</div>
            <div class="smoking-details">
                <h4>{{ i18n "smoking.cigarettesPerDay" }}</h4>
                <small>{{ i18n "smoking.avgConsumption" }}</small>
                <input type="range" class="smoking-slider" id="cigarettesPerDay" min="1" max="60" value="20" oninput="calculate()">
            </div>
            <div class="smoking-value" id="cigarettesValue">20 {{ i18n "smoking.pieces" }}</div>
        </div>

        <div class="smoking-input">
            <div class="smoking-icon">ðŸ’°</div>
            <div class="smoking-details">
                <h4>{{ i18n "smoking.pricePerPack" }}</h4>
                <small>{{ i18n "smoking.avgPrice" }}</small>
                <input type="range" class="smoking-slider" id="pricePerPack" min="7" max="15" value="9.5" step="0.1" oninput="calculate()">
            </div>
            <div class="smoking-value" id="priceValue">CHF 9.50</div>
        </div>

        <div class="smoking-input">
            <div class="smoking-icon">ðŸ“…</div>
            <div class="smoking-details">
                <h4>{{ i18n "smoking.yearsSmoked" }}</h4>
                <small>{{ i18n "smoking.yearsHint" }}</small>
                <input type="range" class="smoking-slider" id="yearsSmoked" min="0" max="50" value="10" oninput="calculate()">
            </div>
            <div class="smoking-value" id="yearsValue">10 {{ i18n "smoking.years" }}</div>
        </div>
    </div>

    <div class="results-grid">
        <div class="result-card">
            <h3><i class="fas fa-coins"></i> {{ i18n "smoking.yourCosts" }}</h3>
            <div class="big-number red" id="yearlyTotal">CHF 3'468</div>
            <div>{{ i18n "perYear" }}</div>

            <div class="cost-breakdown">
                <div class="cost-item">
                    <span class="label">{{ i18n "smoking.perDay" }}</span>
                    <span class="value" id="dailyCost">CHF 9.50</span>
                </div>
                <div class="cost-item">
                    <span class="label">{{ i18n "smoking.perWeek" }}</span>
                    <span class="value" id="weeklyCost">CHF 66.50</span>
                </div>
                <div class="cost-item">
                    <span class="label">{{ i18n "smoking.perMonth" }}</span>
                    <span class="value" id="monthlyCost">CHF 289</span>
                </div>
                <div class="cost-item">
                    <span class="label">{{ i18n "smoking.in10Years" }}</span>
                    <span class="value" id="tenYearCost">CHF 34'675</span>
                </div>
                <div class="cost-item">
                    <span class="label">{{ i18n "smoking.totalSpent" }}</span>
                    <span class="value" id="totalSpent">CHF 34'675</span>
                </div>
            </div>
        </div>

        <div class="result-card">
            <h3><i class="fas fa-shopping-bag"></i> {{ i18n "smoking.whatYouCouldAfford" }}</h3>
            <p style="margin: 0 0 0.5rem 0;">{{ i18n "smoking.withYearlyCosts" }}</p>

            <div class="alternatives">
                <div class="alternative-item">
                    <i class="fas fa-plane"></i>
                    <span class="text">{{ i18n "smoking.vacation" }}</span>
                    <span class="count" id="altVacation">2Ã—</span>
                </div>
                <div class="alternative-item">
                    <i class="fas fa-utensils"></i>
                    <span class="text">{{ i18n "smoking.restaurant" }}</span>
                    <span class="count" id="altDining">69Ã—</span>
                </div>
                <div class="alternative-item">
                    <i class="fas fa-mobile-alt"></i>
                    <span class="text">{{ i18n "smoking.newIphones" }}</span>
                    <span class="count" id="altPhone">3Ã—</span>
                </div>
                <div class="alternative-item">
                    <i class="fas fa-dumbbell"></i>
                    <span class="text">{{ i18n "smoking.gymMembership" }}</span>
                    <span class="count" id="altGym">4Ã—</span>
                </div>
                <div class="alternative-item">
                    <i class="fas fa-ticket-alt"></i>
                    <span class="text">{{ i18n "smoking.concertTickets" }}</span>
                    <span class="count" id="altConcert">35Ã—</span>
                </div>
            </div>

            <div class="savings-box">
                <h3><i class="fas fa-chart-line"></i> {{ i18n "smoking.in10YearsNoSmoking" }}</h3>
                <div class="big-number" id="tenYearSavings">CHF 34'675</div>
                <p>{{ i18n "smoking.enoughFor" }}</p>
            </div>
        </div>

        <div class="result-card">
            <h3><i class="fas fa-heartbeat"></i> {{ i18n "smoking.healthWhenQuitting" }}</h3>
            <p style="margin: 0 0 0.5rem 0;">{{ i18n "smoking.whatHappensWhen" }}</p>

            <div class="health-benefits">
                <div class="health-item">
                    <i class="fas fa-check-circle"></i>
                    <span class="time">{{ i18n "smoking.time20min" }}</span>
                    <span>{{ i18n "smoking.health20min" }}</span>
                </div>
                <div class="health-item">
                    <i class="fas fa-check-circle"></i>
                    <span class="time">{{ i18n "smoking.time12h" }}</span>
                    <span>{{ i18n "smoking.health12h" }}</span>
                </div>
                <div class="health-item">
                    <i class="fas fa-check-circle"></i>
                    <span class="time">{{ i18n "smoking.time2weeks" }}</span>
                    <span>{{ i18n "smoking.health2weeks" }}</span>
                </div>
                <div class="health-item">
                    <i class="fas fa-check-circle"></i>
                    <span class="time">{{ i18n "smoking.time1to9months" }}</span>
                    <span>{{ i18n "smoking.health1to9months" }}</span>
                </div>
                <div class="health-item">
                    <i class="fas fa-check-circle"></i>
                    <span class="time">{{ i18n "smoking.time1year" }}</span>
                    <span>{{ i18n "smoking.health1year" }}</span>
                </div>
                <div class="health-item">
                    <i class="fas fa-check-circle"></i>
                    <span class="time">{{ i18n "smoking.time10years" }}</span>
                    <span>{{ i18n "smoking.health10years" }}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="share-buttons">
        <button class="share-btn primary" onclick="shareResult()">
            <i class="fas fa-share-alt"></i> {{ i18n "share" }}
        </button>
        <button class="share-btn copy" onclick="copyResult()">
            <i class="fas fa-copy"></i> {{ i18n "copy" }}
        </button>
    </div>

    {{ .Content }}

    <div class="info-cards-container" style="margin-top: 2rem;">
        <div class="info-step-card" style="grid-column: 1 / -1;">
            <div class="step-icon"><i class="fas fa-link"></i></div>
            <div class="step-content">
                <h3>{{ i18n "smoking.helpInfo" }}</h3>
                <ul style="margin: 0.5rem 0; list-style: none; padding: 0;">
                    <li style="margin-bottom: 0.5rem;"><a href="{{ i18n "smoking.link1url" }}" target="_blank" rel="noopener"><i class="fas fa-external-link-alt"></i> {{ i18n "smoking.link1text" }}</a></li>
                    <li style="margin-bottom: 0.5rem;"><a href="{{ i18n "smoking.link2url" }}" target="_blank" rel="noopener"><i class="fas fa-external-link-alt"></i> {{ i18n "smoking.link2text" }}</a></li>
                    <li style="margin-bottom: 0.5rem;"><a href="{{ i18n "smoking.link3url" }}" target="_blank" rel="noopener"><i class="fas fa-external-link-alt"></i> {{ i18n "smoking.link3text" }}</a></li>
                    <li style="margin-bottom: 0.5rem;"><a href="{{ i18n "smoking.link4url" }}" target="_blank" rel="noopener"><i class="fas fa-external-link-alt"></i> {{ i18n "smoking.link4text" }}</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>

{{ partial "footer.html" . }}
{{ partial "darkmode.html" . }}

<style>
    .smoking-input { display: flex; align-items: center; gap: 1rem; margin: 1rem 0; padding: 1rem; background: var(--card-bg); border-radius: 12px; border: 1px solid var(--border-color); }
    .smoking-icon { font-size: 2.5rem; width: 60px; text-align: center; }
    .smoking-details { flex: 1; }
    .smoking-details h4 { margin: 0 0 0.25rem 0; color: var(--primary-color); }
    .smoking-details small { color: var(--text-color); opacity: 0.7; }
    .smoking-slider { width: 100%; margin-top: 0.5rem; }
    .smoking-value { font-size: 1.25rem; font-weight: bold; color: var(--secondary-color); min-width: 100px; text-align: right; font-family: 'Economica', sans-serif; }

    .results-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin: 2rem 0; }
    .result-card { background: var(--card-bg); border-radius: 16px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.05); border: 1px solid var(--border-color); }
    .result-card h3 { color: var(--primary-color); margin: 0 0 1rem 0; font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem; }
    .result-card h3 i { opacity: 0.7; }

    .big-number { font-size: 3rem; font-weight: bold; font-family: 'Economica', sans-serif; line-height: 1; }
    .big-number.green { color: #27ae60; }
    .big-number.red { color: #e74c3c; }
    .big-number small { font-size: 1rem; font-weight: normal; opacity: 0.7; }

    .cost-breakdown { margin-top: 1rem; }
    .cost-item { display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border-color); }
    .cost-item:last-child { border-bottom: none; }
    .cost-item .label { color: var(--text-color); }
    .cost-item .value { font-weight: bold; color: var(--accent-color); font-family: 'Economica', sans-serif; font-size: 1.1rem; }

    .alternatives { margin-top: 1rem; }
    .alternative-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; margin: 0.5rem 0; background: var(--light-bg); border-radius: 8px; }
    .alternative-item i { font-size: 1.5rem; width: 40px; color: var(--primary-color); text-align: center; }
    .alternative-item .text { flex: 1; }
    .alternative-item .count { font-weight: bold; color: var(--secondary-color); font-family: 'Economica', sans-serif; font-size: 1.2rem; }

    .savings-box { background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; padding: 1.5rem; border-radius: 16px; margin-top: 1.5rem; text-align: center; }
    .savings-box h3 { color: white; margin: 0 0 0.5rem 0; }
    .savings-box .big-number { color: white; }
    .savings-box p { margin: 0.5rem 0 0 0; opacity: 0.9; }

    .health-benefits { margin-top: 1rem; }
    .health-item { display: flex; align-items: flex-start; gap: 0.75rem; padding: 0.75rem 0; border-bottom: 1px solid var(--border-color); }
    .health-item:last-child { border-bottom: none; }
    .health-item i { color: #27ae60; margin-top: 0.2rem; }
    .health-item .time { font-weight: bold; color: var(--primary-color); min-width: 100px; }

    .share-buttons { display: flex; gap: 0.5rem; justify-content: center; margin-top: 1.5rem; flex-wrap: wrap; }
    .share-btn { padding: 0.75rem 1.25rem; border-radius: 8px; border: none; cursor: pointer; font-size: 0.9rem; display: flex; align-items: center; gap: 0.5rem; transition: all 0.2s; }
    .share-btn.primary { background: var(--primary-color); color: white; }
    .share-btn.copy { background: var(--secondary-color); color: white; }
    .share-btn:hover { transform: translateY(-2px); }

    input[type="range"] { width: 100%; height: 8px; border-radius: 4px; background: var(--border-color); outline: none; -webkit-appearance: none; }
    input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 24px; height: 24px; border-radius: 50%; background: var(--primary-color); cursor: pointer; }
</style>

<script>
    // Translations for JavaScript
    const TEXTS = {
        pieces: "{{ i18n "smoking.pieces" }}",
        years: "{{ i18n "smoking.years" }}",
        perYear: "{{ i18n "perYear" }}",
        shareText: "{{ i18n "smoking.shareText" }}",
        shareUrl: "{{ i18n "smoking.shareUrl" }}"
    };

    // Price references
    const VACATION_COST = 1500; // CHF per vacation
    const DINING_COST = 50; // CHF per restaurant visit
    const PHONE_COST = 1200; // CHF per iPhone
    const GYM_COST = 800; // CHF per year
    const CONCERT_COST = 100; // CHF per ticket

    function calculate() {
        const cigarettesPerDay = parseInt(document.getElementById('cigarettesPerDay').value);
        const pricePerPack = parseFloat(document.getElementById('pricePerPack').value);
        const yearsSmoked = parseInt(document.getElementById('yearsSmoked').value);

        // Update display values
        document.getElementById('cigarettesValue').textContent = cigarettesPerDay + ' ' + TEXTS.pieces;
        document.getElementById('priceValue').textContent = 'CHF ' + pricePerPack.toFixed(2);
        document.getElementById('yearsValue').textContent = yearsSmoked + ' ' + TEXTS.years;

        // Calculate costs
        const pricePerCigarette = pricePerPack / 20;
        const dailyCost = cigarettesPerDay * pricePerCigarette;
        const weeklyCost = dailyCost * 7;
        const monthlyCost = dailyCost * 30.44; // Average days per month
        const yearlyCost = dailyCost * 365;
        const tenYearCost = yearlyCost * 10;
        const totalSpent = yearlyCost * yearsSmoked;

        // Update cost display
        document.getElementById('dailyCost').textContent = formatCHF(dailyCost);
        document.getElementById('weeklyCost').textContent = formatCHF(weeklyCost);
        document.getElementById('monthlyCost').textContent = formatCHF(monthlyCost);
        document.getElementById('yearlyTotal').textContent = formatCHF(yearlyCost);
        document.getElementById('tenYearCost').textContent = formatCHF(tenYearCost);
        document.getElementById('totalSpent').textContent = formatCHF(totalSpent);
        document.getElementById('tenYearSavings').textContent = formatCHF(tenYearCost);

        // Update alternatives
        document.getElementById('altVacation').textContent = Math.floor(yearlyCost / VACATION_COST) + 'Ã—';
        document.getElementById('altDining').textContent = Math.floor(yearlyCost / DINING_COST) + 'Ã—';
        document.getElementById('altPhone').textContent = Math.floor(yearlyCost / PHONE_COST) + 'Ã—';
        document.getElementById('altGym').textContent = Math.floor(yearlyCost / GYM_COST) + 'Ã—';
        document.getElementById('altConcert').textContent = Math.floor(yearlyCost / CONCERT_COST) + 'Ã—';
    }

    function formatCHF(amount) {
        return 'CHF ' + Math.round(amount).toLocaleString('de-CH');
    }

    function getShareText() {
        const yearly = document.getElementById('yearlyTotal').textContent;
        const tenYear = document.getElementById('tenYearSavings').textContent;
        const cigarettes = document.getElementById('cigarettesPerDay').value;

        return TEXTS.shareText
            .replace('{cigarettes}', cigarettes)
            .replace('{yearly}', yearly)
            .replace('{tenYear}', tenYear) + '\n\n' + TEXTS.shareUrl;
    }

    function shareResult() {
        const shareData = { title: document.title, text: getShareText(), url: window.location.href };
        if (navigator.share && navigator.canShare && navigator.canShare(shareData)) {
            navigator.share(shareData).catch(() => {});
        } else {
            window.open('https://wa.me/?text=' + encodeURIComponent(getShareText()), '_blank');
        }
    }

    function copyResult() {
        navigator.clipboard.writeText(getShareText()).then(() => {
            const btn = document.querySelector('.share-btn.copy');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-check"></i> {{ i18n "copied" }}';
            setTimeout(() => btn.innerHTML = originalText, 2000);
        });
    }

    // Initialize
    calculate();
</script>
