{{ partial "head.html" . }}

<body>
    <div class="container">
        {{ partial "header.html" . }}

        {{ partial "page-header.html" . }}

        <div class="steps-container">
            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-paw"></i>
                    <div class="step-number">1</div>
                </div>
                <div class="step-content">
                    <h3>{{ i18n "pet.step1Title" }}</h3>
                    <p>{{ i18n "pet.step1Desc" }}</p>
                </div>
            </div>
            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-sliders-h"></i>
                    <div class="step-number">2</div>
                </div>
                <div class="step-content">
                    <h3>{{ i18n "pet.step2Title" }}</h3>
                    <p>{{ i18n "pet.step2Desc" }}</p>
                </div>
            </div>
            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-coins"></i>
                    <div class="step-number">3</div>
                </div>
                <div class="step-content">
                    <h3>{{ i18n "pet.step3Title" }}</h3>
                    <p>{{ i18n "pet.step3Desc" }}</p>
                </div>
            </div>
        </div>

        <div class="calculator-card">
            <div class="form-group">
                <label>{{ i18n "pet.whichPet" }}</label>
                <div class="pet-type">
                    <button type="button" class="pet-btn active" data-type="dog" onclick="setPetType('dog')">
                        <span class="pet-emoji">üêï</span>
                        <span>{{ i18n "pet.dog" }}</span>
                        <small>{{ i18n "pet.dogLifespan" }}</small>
                    </button>
                    <button type="button" class="pet-btn" data-type="cat" onclick="setPetType('cat')">
                        <span class="pet-emoji">üêà</span>
                        <span>{{ i18n "pet.cat" }}</span>
                        <small>{{ i18n "pet.catLifespan" }}</small>
                    </button>
                </div>
            </div>

            <div class="form-group" id="sizeGroup">
                <label>{{ i18n "pet.dogSize" }}</label>
                <div class="size-select">
                    <button type="button" class="size-btn" data-size="small" onclick="setSize('small')">{{ i18n "pet.dogSmall" }}<br><small>&lt;10 kg</small></button>
                    <button type="button" class="size-btn active" data-size="medium" onclick="setSize('medium')">{{ i18n "pet.dogMedium" }}<br><small>10-25 kg</small></button>
                    <button type="button" class="size-btn" data-size="large" onclick="setSize('large')">{{ i18n "pet.dogLarge" }}<br><small>&gt;25 kg</small></button>
                </div>
            </div>

            <div class="form-group" id="catTypeGroup" style="display: none;">
                <label>{{ i18n "pet.catType" }}</label>
                <div class="size-select">
                    <button type="button" class="size-btn active" data-cat="indoor" onclick="setCatType('indoor')">{{ i18n "pet.catIndoor" }}</button>
                    <button type="button" class="size-btn" data-cat="outdoor" onclick="setCatType('outdoor')">{{ i18n "pet.catOutdoor" }}</button>
                </div>
            </div>

            <div class="slider-group">
                <label for="lifespan">{{ i18n "pet.lifeExpectancy" }}: <span id="lifespanValue">12</span> {{ i18n "pet.years" }}</label>
                <input type="range" id="lifespan" min="8" max="20" value="12" oninput="updateLifespan()">
                <div class="slider-value">
                    <span>8 {{ i18n "pet.years" }}</span>
                    <span>20 {{ i18n "pet.years" }}</span>
                </div>
            </div>

            <div class="form-group">
                <label>{{ i18n "pet.extras" }}</label>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal; cursor: pointer;">
                        <input type="checkbox" id="insurance" checked onchange="calculate()">
                        <span>{{ i18n "pet.insurance" }}</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal; cursor: pointer;">
                        <input type="checkbox" id="grooming" onchange="calculate()">
                        <span id="groomingLabel">{{ i18n "pet.grooming" }}</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal; cursor: pointer;">
                        <input type="checkbox" id="training" onchange="calculate()">
                        <span id="trainingLabel">{{ i18n "pet.training" }}</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal; cursor: pointer;">
                        <input type="checkbox" id="boarding" onchange="calculate()">
                        <span>{{ i18n "pet.boarding" }}</span>
                    </label>
                </div>
            </div>
        </div>

        <div id="results">
            <div class="result-box">
                <div class="label">{{ i18n "pet.lifetimeCost" }}</div>
                <div class="total" id="lifetimeCost">CHF 24'000</div>
                <div class="sub" id="resultSub"></div>
            </div>

            <div class="cost-grid">
                <div class="cost-box">
                    <div class="box-label">{{ i18n "pet.perYear" }}</div>
                    <div class="box-value" id="yearlyCost">CHF 2'000</div>
                    <div class="box-sub">{{ i18n "pet.runningCosts" }}</div>
                </div>
                <div class="cost-box">
                    <div class="box-label">{{ i18n "pet.perMonth" }}</div>
                    <div class="box-value" id="monthlyCost">CHF 167</div>
                    <div class="box-sub">{{ i18n "pet.average" }}</div>
                </div>
                <div class="cost-box">
                    <div class="box-label">{{ i18n "pet.initialEquipment" }}</div>
                    <div class="box-value" id="initialCost">CHF 500</div>
                    <div class="box-sub">{{ i18n "pet.oneTime" }}</div>
                </div>
                <div class="cost-box highlight">
                    <div class="box-label">{{ i18n "pet.acquisition" }}</div>
                    <div class="box-value" id="purchaseCost">CHF 1'500</div>
                    <div class="box-sub">{{ i18n "pet.breederShelter" }}</div>
                </div>
            </div>

            <div class="breakdown-card">
                <h3><i class="fas fa-receipt"></i> {{ i18n "pet.yearlyCosts" }}</h3>
                <div class="breakdown-row">
                    <span class="label"><i class="fas fa-bone"></i> {{ i18n "pet.food" }}</span>
                    <span class="value" id="foodCost">CHF 780</span>
                </div>
                <div class="breakdown-row">
                    <span class="label"><i class="fas fa-stethoscope"></i> {{ i18n "pet.vet" }}</span>
                    <span class="value" id="vetCost">CHF 350</span>
                </div>
                <div class="breakdown-row" id="insuranceRow">
                    <span class="label"><i class="fas fa-shield-alt"></i> {{ i18n "pet.insurance" }}</span>
                    <span class="value" id="insuranceCost">CHF 300</span>
                </div>
                <div class="breakdown-row" id="liabilityRow">
                    <span class="label"><i class="fas fa-file-contract"></i> {{ i18n "pet.liability" }}</span>
                    <span class="value" id="liabilityCost">CHF 100</span>
                </div>
                <div class="breakdown-row" id="taxRow">
                    <span class="label"><i class="fas fa-landmark"></i> {{ i18n "pet.dogTax" }}</span>
                    <span class="value" id="taxCost">CHF 120</span>
                </div>
                <div class="breakdown-row" id="litterRow" style="display: none;">
                    <span class="label"><i class="fas fa-box"></i> {{ i18n "pet.litter" }}</span>
                    <span class="value" id="litterCost">CHF 200</span>
                </div>
                <div class="breakdown-row" id="groomingRow" style="display: none;">
                    <span class="label"><i class="fas fa-cut"></i> {{ i18n "pet.groomingCost" }}</span>
                    <span class="value" id="groomingCost">CHF 280</span>
                </div>
                <div class="breakdown-row" id="trainingRow" style="display: none;">
                    <span class="label"><i class="fas fa-graduation-cap"></i> {{ i18n "pet.trainingCost" }}</span>
                    <span class="value" id="trainingCost">CHF 400</span>
                </div>
                <div class="breakdown-row" id="boardingRow" style="display: none;">
                    <span class="label"><i class="fas fa-suitcase"></i> {{ i18n "pet.boardingCost" }}</span>
                    <span class="value" id="boardingCost">CHF 700</span>
                </div>
                <div class="breakdown-row">
                    <span class="label"><i class="fas fa-shopping-bag"></i> {{ i18n "pet.accessories" }}</span>
                    <span class="value" id="accessoryCost">CHF 150</span>
                </div>
                <div class="breakdown-row total">
                    <span class="label">{{ i18n "pet.totalPerYear" }}</span>
                    <span class="value" id="totalYearly">CHF 2'000</span>
                </div>
            </div>

            <div class="comparison-section">
                <h3><i class="fas fa-balance-scale"></i> {{ i18n "pet.equivalentTo" }}</h3>
                <div class="comparison-item">
                    <span class="comp-icon">‚òï</span>
                    <span class="comp-text">{{ i18n "pet.coffeesPerMonth" }}</span>
                    <span class="comp-value" id="coffeeComp">33</span>
                </div>
                <div class="comparison-item">
                    <span class="comp-icon">üçï</span>
                    <span class="comp-text">{{ i18n "pet.pizzasPerYear" }}</span>
                    <span class="comp-value" id="pizzaComp">80</span>
                </div>
                <div class="comparison-item">
                    <span class="comp-icon">‚úàÔ∏è</span>
                    <span class="comp-text">{{ i18n "pet.tripsPerYear" }}</span>
                    <span class="comp-value" id="tripComp">4</span>
                </div>
            </div>

            <div class="info-box">
                <i class="fas fa-info-circle"></i>
                <strong>{{ i18n "pet.goodToKnow" }}:</strong> {{ i18n "pet.costInfo" }}
            </div>

            <div class="share-buttons">
                <button class="share-btn primary" onclick="shareResult()">
                    <i class="fas fa-share-alt"></i> {{ i18n "share" }}
                </button>
                <button class="share-btn copy" onclick="copyResult()">
                    <i class="fas fa-copy"></i> {{ i18n "copy" }}
                </button>
            </div>
        </div>

        {{ .Content }}

    </div>

    {{ partial "footer.html" . }}

    <style>
        .pet-type { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin: 1rem 0; }
        .pet-btn { padding: 1.5rem; border-radius: 12px; border: 2px solid var(--border-color); background: var(--card-bg); cursor: pointer; text-align: center; transition: all 0.2s; color: var(--text-color); }
        .pet-btn:hover { border-color: var(--primary-color); }
        .pet-btn.active { border-color: var(--primary-color); background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: white; }
        .pet-btn .pet-emoji { font-size: 2.5rem; display: block; margin-bottom: 0.5rem; }
        .pet-btn span { font-size: 1rem; font-weight: 600; display: block; }
        .pet-btn small { font-size: 0.8rem; opacity: 0.8; margin-top: 0.25rem; display: block; }

        .size-select { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; margin: 0.5rem 0; }
        .size-btn { padding: 0.75rem; border-radius: 8px; border: 2px solid var(--border-color); background: var(--card-bg); cursor: pointer; text-align: center; transition: all 0.2s; color: var(--text-color); font-size: 0.85rem; }
        .size-btn:hover { border-color: var(--primary-color); }
        .size-btn.active { border-color: var(--primary-color); background: var(--primary-color); color: white; }

        .result-box { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: white; padding: 2rem; border-radius: 16px; text-align: center; margin: 1.5rem 0; }
        .result-box .label { opacity: 0.9; margin-bottom: 0.5rem; }
        .result-box .total { font-size: 2.5rem; font-weight: bold; font-family: 'Economica', sans-serif; }
        .result-box .sub { font-size: 1rem; opacity: 0.9; margin-top: 0.5rem; }

        .cost-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1.5rem 0; }
        .cost-box { background: var(--card-bg); border-radius: 12px; padding: 1.25rem; text-align: center; border: 2px solid var(--border-color); }
        .cost-box.highlight { border-color: var(--accent-color); background: rgba(204, 92, 83, 0.05); }
        .cost-box .box-label { font-size: 0.85rem; color: var(--text-color); opacity: 0.8; margin-bottom: 0.5rem; }
        .cost-box .box-value { font-size: 1.5rem; font-weight: bold; font-family: 'Economica', sans-serif; color: var(--primary-color); }
        .cost-box.highlight .box-value { color: var(--accent-color); }
        .cost-box .box-sub { font-size: 0.8rem; color: var(--text-color); opacity: 0.7; margin-top: 0.25rem; }

        .breakdown-card { background: var(--card-bg); border-radius: 12px; padding: 1.5rem; margin-top: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.05); border: 1px solid var(--border-color); }
        .breakdown-card h3 { color: var(--primary-color); margin-bottom: 1rem; font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem; }
        .breakdown-row { display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border-color); align-items: center; }
        .breakdown-row:last-child { border-bottom: none; }
        .breakdown-row .label { color: var(--text-color); display: flex; align-items: center; gap: 0.5rem; }
        .breakdown-row .label i { color: var(--primary-color); width: 20px; }
        .breakdown-row .value { font-weight: 600; color: var(--primary-color); }
        .breakdown-row.total { font-weight: bold; background: var(--light-bg); margin: 0.5rem -1.5rem -1.5rem; padding: 1rem 1.5rem; border-radius: 0 0 12px 12px; }
        .breakdown-row.total .value { color: var(--accent-color); font-size: 1.1rem; }

        .comparison-section { margin: 2rem 0; }
        .comparison-section h3 { color: var(--primary-color); margin-bottom: 1rem; font-size: 1.1rem; }
        .comparison-item { display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--card-bg); border-radius: 8px; margin-bottom: 0.5rem; border: 1px solid var(--border-color); }
        .comparison-item .comp-icon { font-size: 1.5rem; }
        .comparison-item .comp-text { flex: 1; font-size: 0.9rem; }
        .comparison-item .comp-value { font-weight: 600; color: var(--primary-color); }

        .info-box { background: rgba(63, 96, 111, 0.1); border-left: 4px solid var(--primary-color); padding: 1rem; border-radius: 0 8px 8px 0; margin: 1rem 0; font-size: 0.9rem; }
        .info-box strong { color: var(--primary-color); }

        .share-buttons { display: flex; gap: 0.5rem; justify-content: center; margin-top: 1.5rem; flex-wrap: wrap; }
        .share-btn { padding: 0.75rem 1.25rem; border-radius: 8px; border: none; cursor: pointer; font-size: 0.9rem; display: flex; align-items: center; gap: 0.5rem; transition: all 0.2s; }
        .share-btn.primary { background: var(--primary-color); color: white; }
        .share-btn.copy { background: var(--secondary-color); color: white; }
        .share-btn:hover { transform: translateY(-2px); }

        .slider-group { margin: 1rem 0; }
        .slider-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; }
        .slider-group input[type="range"] { width: 100%; }
        .slider-value { display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--text-color); opacity: 0.8; margin-top: 0.25rem; }

        @media (max-width: 500px) {
            .pet-type { grid-template-columns: 1fr; }
            .cost-grid { grid-template-columns: 1fr; }
            .result-box .total { font-size: 2rem; }
            .size-select { grid-template-columns: 1fr; }
        }
    </style>

    <script>
        // Localized texts from Hugo i18n
        const TEXTS = {
            dog: {{ i18n "pet.dog" | safeJS }},
            cat: {{ i18n "pet.cat" | safeJS }},
            forYears: {{ i18n "pet.forYearsOwnership" | safeJS }},
            dogOwnership: {{ i18n "pet.dogOwnership" | safeJS }},
            catOwnership: {{ i18n "pet.catOwnership" | safeJS }},
            grooming: {{ i18n "pet.grooming" | safeJS }},
            training: {{ i18n "pet.training" | safeJS }},
            catGrooming: {{ i18n "pet.catGrooming" | safeJS }},
            catTraining: {{ i18n "pet.catTraining" | safeJS }},
            shareText: {{ i18n "pet.shareText" | safeJS }}
        };

        // Pet cost data (CHF per year, Swiss averages)
        const COSTS = {
            dog: {
                small: {
                    food: 480, vet: 300, insurance: 250, liability: 80, tax: 100,
                    accessories: 100, grooming: 200, training: 300, boarding: 500,
                    initial: 400, purchase: { min: 1000, max: 2500 }, lifespan: 14
                },
                medium: {
                    food: 780, vet: 350, insurance: 300, liability: 100, tax: 120,
                    accessories: 150, grooming: 280, training: 400, boarding: 700,
                    initial: 500, purchase: { min: 1500, max: 3000 }, lifespan: 12
                },
                large: {
                    food: 1200, vet: 450, insurance: 400, liability: 120, tax: 150,
                    accessories: 200, grooming: 350, training: 500, boarding: 900,
                    initial: 600, purchase: { min: 1500, max: 3500 }, lifespan: 10
                }
            },
            cat: {
                indoor: {
                    food: 500, vet: 250, insurance: 200, litter: 250,
                    accessories: 100, lifespan: 16,
                    initial: 300, purchase: { min: 100, max: 1500 }
                },
                outdoor: {
                    food: 550, vet: 350, insurance: 250, litter: 150,
                    accessories: 120, lifespan: 14,
                    initial: 350, purchase: { min: 100, max: 1500 }
                }
            }
        };

        let petType = 'dog';
        let dogSize = 'medium';
        let catType = 'indoor';

        function setPetType(type) {
            petType = type;
            document.querySelectorAll('.pet-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.type === type);
            });

            document.getElementById('sizeGroup').style.display = type === 'dog' ? 'block' : 'none';
            document.getElementById('catTypeGroup').style.display = type === 'cat' ? 'block' : 'none';

            document.getElementById('liabilityRow').style.display = type === 'dog' ? 'flex' : 'none';
            document.getElementById('taxRow').style.display = type === 'dog' ? 'flex' : 'none';
            document.getElementById('litterRow').style.display = type === 'cat' ? 'flex' : 'none';

            const defaultLifespan = type === 'dog' ? COSTS.dog[dogSize].lifespan : COSTS.cat[catType].lifespan;
            document.getElementById('lifespan').value = defaultLifespan;
            document.getElementById('lifespanValue').textContent = defaultLifespan;

            document.getElementById('groomingLabel').textContent = type === 'dog' ? TEXTS.grooming : TEXTS.catGrooming;
            document.getElementById('trainingLabel').textContent = type === 'dog' ? TEXTS.training : TEXTS.catTraining;

            calculate();
        }

        function setSize(size) {
            dogSize = size;
            document.querySelectorAll('#sizeGroup .size-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.size === size);
            });
            document.getElementById('lifespan').value = COSTS.dog[size].lifespan;
            document.getElementById('lifespanValue').textContent = COSTS.dog[size].lifespan;
            calculate();
        }

        function setCatType(type) {
            catType = type;
            document.querySelectorAll('#catTypeGroup .size-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.cat === type);
            });
            document.getElementById('lifespan').value = COSTS.cat[type].lifespan;
            document.getElementById('lifespanValue').textContent = COSTS.cat[type].lifespan;
            calculate();
        }

        function updateLifespan() {
            const value = document.getElementById('lifespan').value;
            document.getElementById('lifespanValue').textContent = value;
            calculate();
        }

        function calculate() {
            const lifespan = parseInt(document.getElementById('lifespan').value);
            const hasInsurance = document.getElementById('insurance').checked;
            const hasGrooming = document.getElementById('grooming').checked;
            const hasTraining = document.getElementById('training').checked;
            const hasBoarding = document.getElementById('boarding').checked;

            let costs;
            if (petType === 'dog') {
                costs = COSTS.dog[dogSize];
            } else {
                costs = COSTS.cat[catType];
            }

            let yearly = costs.food + costs.vet + costs.accessories;

            if (petType === 'dog') {
                yearly += costs.liability + costs.tax;
                if (hasInsurance) yearly += costs.insurance;
                if (hasGrooming) yearly += costs.grooming;
                if (hasTraining) yearly += costs.training;
                if (hasBoarding) yearly += costs.boarding;
            } else {
                yearly += costs.litter;
                if (hasInsurance) yearly += costs.insurance;
                if (hasGrooming) yearly += 150;
                if (hasTraining) yearly += 100;
                if (hasBoarding) yearly += 400;
            }

            const initial = costs.initial;
            const purchaseAvg = (costs.purchase.min + costs.purchase.max) / 2;
            const lifetime = initial + purchaseAvg + (yearly * lifespan);
            const monthly = yearly / 12;

            document.getElementById('lifetimeCost').textContent = formatCHF(lifetime);
            document.getElementById('resultSub').textContent =
                TEXTS.forYears.replace('{years}', lifespan) + ' ' +
                (petType === 'dog' ? TEXTS.dogOwnership : TEXTS.catOwnership);
            document.getElementById('yearlyCost').textContent = formatCHF(yearly);
            document.getElementById('monthlyCost').textContent = formatCHF(monthly);
            document.getElementById('initialCost').textContent = formatCHF(initial);
            document.getElementById('purchaseCost').textContent =
                `CHF ${costs.purchase.min.toLocaleString('de-CH')}‚Äì${costs.purchase.max.toLocaleString('de-CH')}`;

            document.getElementById('foodCost').textContent = formatCHF(costs.food);
            document.getElementById('vetCost').textContent = formatCHF(costs.vet);
            document.getElementById('accessoryCost').textContent = formatCHF(costs.accessories);

            if (petType === 'dog') {
                document.getElementById('insuranceCost').textContent = hasInsurance ? formatCHF(costs.insurance) : '‚Äì';
                document.getElementById('liabilityCost').textContent = formatCHF(costs.liability);
                document.getElementById('taxCost').textContent = formatCHF(costs.tax);

                document.getElementById('insuranceRow').style.display = 'flex';
                document.getElementById('groomingRow').style.display = hasGrooming ? 'flex' : 'none';
                document.getElementById('trainingRow').style.display = hasTraining ? 'flex' : 'none';
                document.getElementById('boardingRow').style.display = hasBoarding ? 'flex' : 'none';

                if (hasGrooming) document.getElementById('groomingCost').textContent = formatCHF(costs.grooming);
                if (hasTraining) document.getElementById('trainingCost').textContent = formatCHF(costs.training);
                if (hasBoarding) document.getElementById('boardingCost').textContent = formatCHF(costs.boarding);
            } else {
                document.getElementById('litterCost').textContent = formatCHF(costs.litter);
                document.getElementById('insuranceRow').style.display = hasInsurance ? 'flex' : 'none';
                if (hasInsurance) document.getElementById('insuranceCost').textContent = formatCHF(costs.insurance);

                document.getElementById('groomingRow').style.display = hasGrooming ? 'flex' : 'none';
                document.getElementById('trainingRow').style.display = hasTraining ? 'flex' : 'none';
                document.getElementById('boardingRow').style.display = hasBoarding ? 'flex' : 'none';

                if (hasGrooming) document.getElementById('groomingCost').textContent = formatCHF(150);
                if (hasTraining) document.getElementById('trainingCost').textContent = formatCHF(100);
                if (hasBoarding) document.getElementById('boardingCost').textContent = formatCHF(400);
            }

            document.getElementById('totalYearly').textContent = formatCHF(yearly);

            document.getElementById('coffeeComp').textContent = Math.round(monthly / 5);
            document.getElementById('pizzaComp').textContent = Math.round(yearly / 25);
            document.getElementById('tripComp').textContent = (yearly / 500).toFixed(1);
        }

        function formatCHF(amount) {
            return 'CHF ' + Math.round(amount).toLocaleString('de-CH');
        }

        function getShareText() {
            const lifetime = document.getElementById('lifetimeCost').textContent;
            const yearly = document.getElementById('yearlyCost').textContent;
            const lifespan = document.getElementById('lifespan').value;
            const animal = petType === 'dog' ? TEXTS.dog : TEXTS.cat;

            return TEXTS.shareText
                .replace('{animal}', animal)
                .replace('{years}', lifespan)
                .replace('{yearly}', yearly)
                .replace('{lifetime}', lifetime);
        }

        function shareResult() {
            const shareData = { title: document.title, text: getShareText(), url: window.location.href };
            if (navigator.share && navigator.canShare && navigator.canShare(shareData)) {
                navigator.share(shareData).catch(() => {});
            } else {
                window.open('https://wa.me/?text=' + encodeURIComponent(getShareText()), '_blank');
            }
        }

        function copyResult() {
            navigator.clipboard.writeText(getShareText()).then(() => {
                const btn = document.querySelector('.share-btn.copy');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check"></i> {{ i18n "copied" | safeJS }}';
                setTimeout(() => btn.innerHTML = originalText, 2000);
            });
        }

        {{ partial "darkmode.html" . }}

        calculate();
    </script>
</body>
</html>
