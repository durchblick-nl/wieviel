<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculateur d'alcool√©mie Suisse - Taux d'alcool | calcule.ch</title>
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <meta name="description" content="Calculez votre taux d'alcool√©mie (TAC) avec le calculateur suisse. D√©couvrez quand vous serez √† nouveau apte √† conduire.">
    <meta name="keywords" content="calculateur alcool√©mie, taux alcool, TAC, alcool, Suisse, aptitude √† conduire, Widmark">
    <link rel="canonical" href="https://calcule.ch/alcoolemie/">
    <link rel="alternate" hreflang="de" href="https://wieviel.ch/promille/">
    <link rel="alternate" hreflang="fr" href="https://calcule.ch/alcoolemie/">
    <meta property="og:title" content="Calculateur d'alcool√©mie Suisse">
    <meta property="og:description" content="Calculez votre taux d'alcool√©mie et d√©couvrez quand vous serez √† nouveau apte √† conduire.">
    <meta property="og:url" content="https://calcule.ch/alcoolemie/">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="fr_CH">
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Calculateur d'alcool√©mie Suisse",
        "url": "https://calcule.ch/alcoolemie/",
        "description": "Calculez votre taux d'alcool√©mie avec la formule de Widmark.",
        "applicationCategory": "HealthApplication",
        "operatingSystem": "Web",
        "offers": { "@type": "Offer", "price": "0", "priceCurrency": "CHF" }
    }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Economica:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .faq-section { display: flex; flex-direction: column; gap: 0.5rem; margin-top: 1rem; }
        .faq-item { background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 8px; overflow: hidden; }
        .faq-item summary { padding: 1rem; cursor: pointer; font-weight: 600; color: var(--text-color); list-style: none; display: flex; justify-content: space-between; align-items: center; }
        .faq-item summary::-webkit-details-marker { display: none; }
        .faq-item summary::after { content: '+'; font-size: 1.25rem; color: var(--primary-color); }
        .faq-item[open] summary::after { content: '‚àí'; }
        .faq-item[open] summary { border-bottom: 1px solid var(--border-color); background: var(--light-bg); }
        .faq-item p { padding: 1rem; margin: 0; font-size: 0.95rem; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-row">
            <button type="button" class="dark-mode-toggle" aria-label="Mode sombre" onclick="DarkMode.toggle()">
                <i class="fas fa-moon"></i>
            </button>
            <div class="language-switcher">
                <a href="https://wieviel.ch/promille/" class="lang-btn">DE</a>
                <span class="lang-btn active">FR</span>
            </div>
        </div>

        <div class="page-header">
            <h1><span class="title-icon">üç∫</span>Calculateur d'alcool√©mie</h1>
            <p class="page-subtitle">Taux d'alcool selon Watson</p>
        </div>

        <nav class="tool-nav">
            <a href="../">Tous les outils</a>
        </nav>

        <div class="steps-container">
            <div class="step-card">
                <div class="step-icon"><i class="fas fa-user"></i><div class="step-number">1</div></div>
                <div class="step-content"><h3>Donn√©es personnelles</h3><p>Le sexe et le poids corporel influencent l'absorption.</p></div>
            </div>
            <div class="step-card">
                <div class="step-icon"><i class="fas fa-beer-mug-empty"></i><div class="step-number">2</div></div>
                <div class="step-content"><h3>Saisir les boissons</h3><p>S√©lectionnez le type et la quantit√© de boissons.</p></div>
            </div>
            <div class="step-card">
                <div class="step-icon"><i class="fas fa-clock"></i><div class="step-number">3</div></div>
                <div class="step-content"><h3>R√©sultat</h3><p>Consultez votre taux et le temps d'√©limination.</p></div>
            </div>
        </div>

        <div class="calculator-card">
            <form id="promilleForm">
                <div class="form-group">
                    <label class="required">Sexe</label>
                    <div class="gender-selection">
                        <button type="button" class="gender-btn active" data-gender="male" onclick="selectGender('male')"><i class="fas fa-mars"></i><span>Homme</span></button>
                        <button type="button" class="gender-btn" data-gender="female" onclick="selectGender('female')"><i class="fas fa-venus"></i><span>Femme</span></button>
                    </div>
                </div>

                <div class="form-group">
                    <div class="slider-group">
                        <div class="slider-header">
                            <label class="required">Poids corporel</label>
                            <span class="slider-value" id="weightValue">75 kg</span>
                        </div>
                        <input type="range" id="weight" min="40" max="150" value="75" oninput="updateWeight(this.value)">
                    </div>
                </div>

                <div class="form-group">
                    <div class="slider-group">
                        <div class="slider-header">
                            <label class="required">Taille</label>
                            <span class="slider-value" id="heightValue">175 cm</span>
                        </div>
                        <input type="range" id="height" min="140" max="210" value="175" oninput="updateHeight(this.value)">
                    </div>
                </div>

                <div class="form-group">
                    <div class="slider-group">
                        <div class="slider-header">
                            <label class="required">√Çge</label>
                            <span class="slider-value" id="ageValue">30 ans</span>
                        </div>
                        <input type="range" id="age" min="18" max="80" value="30" oninput="updateAge(this.value)">
                    </div>
                </div>

                <div class="form-group">
                    <label class="required">Qu'avez-vous bu ?</label>
                    <div class="drinks-grid">
                        <div class="drink-card" id="drink-beer">
                            <div class="drink-icon">üç∫</div>
                            <div class="drink-name">Bi√®re</div>
                            <div class="drink-info">3dl, 5%</div>
                            <div class="drink-counter">
                                <button type="button" onclick="changeDrink('beer', -1)" disabled>‚àí</button>
                                <span class="drink-count" id="count-beer">0</span>
                                <button type="button" onclick="changeDrink('beer', 1)">+</button>
                            </div>
                        </div>
                        <div class="drink-card" id="drink-beer-large">
                            <div class="drink-icon">üçª</div>
                            <div class="drink-name">Grande bi√®re</div>
                            <div class="drink-info">5dl, 5%</div>
                            <div class="drink-counter">
                                <button type="button" onclick="changeDrink('beer-large', -1)" disabled>‚àí</button>
                                <span class="drink-count" id="count-beer-large">0</span>
                                <button type="button" onclick="changeDrink('beer-large', 1)">+</button>
                            </div>
                        </div>
                        <div class="drink-card" id="drink-wine">
                            <div class="drink-icon">üç∑</div>
                            <div class="drink-name">Vin</div>
                            <div class="drink-info">1dl, 12%</div>
                            <div class="drink-counter">
                                <button type="button" onclick="changeDrink('wine', -1)" disabled>‚àí</button>
                                <span class="drink-count" id="count-wine">0</span>
                                <button type="button" onclick="changeDrink('wine', 1)">+</button>
                            </div>
                        </div>
                        <div class="drink-card" id="drink-wine-glass">
                            <div class="drink-icon">ü•Ç</div>
                            <div class="drink-name">Verre de vin</div>
                            <div class="drink-info">1.5dl, 12%</div>
                            <div class="drink-counter">
                                <button type="button" onclick="changeDrink('wine-glass', -1)" disabled>‚àí</button>
                                <span class="drink-count" id="count-wine-glass">0</span>
                                <button type="button" onclick="changeDrink('wine-glass', 1)">+</button>
                            </div>
                        </div>
                        <div class="drink-card" id="drink-shot">
                            <div class="drink-icon">ü•É</div>
                            <div class="drink-name">Spiritueux</div>
                            <div class="drink-info">4cl, 40%</div>
                            <div class="drink-counter">
                                <button type="button" onclick="changeDrink('shot', -1)" disabled>‚àí</button>
                                <span class="drink-count" id="count-shot">0</span>
                                <button type="button" onclick="changeDrink('shot', 1)">+</button>
                            </div>
                        </div>
                        <div class="drink-card" id="drink-cocktail">
                            <div class="drink-icon">üç∏</div>
                            <div class="drink-name">Cocktail</div>
                            <div class="drink-info">~4cl alc.</div>
                            <div class="drink-counter">
                                <button type="button" onclick="changeDrink('cocktail', -1)" disabled>‚àí</button>
                                <span class="drink-count" id="count-cocktail">0</span>
                                <button type="button" onclick="changeDrink('cocktail', 1)">+</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>P√©riode de consommation</label>
                    <div class="time-inputs">
                        <div><label for="startTime">D√©but</label><input type="time" id="startTime" value="20:00"></div>
                        <div><label for="endTime">Fin / Maintenant</label><input type="time" id="endTime"></div>
                    </div>
                </div>

                <div class="warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Important :</strong> Ce calculateur fournit uniquement des estimations. En cas de doute : ne conduisez pas !
                </div>

                <div class="warning" id="drinkWarning" style="display: none; background-color: #f8d7da; border-left-color: #dc3545;">
                    <i class="fas fa-ban" style="color: #dc3545;"></i>
                    <strong>Recommandation :</strong> Toute personne ayant consomm√© de l'alcool ne devrait pas conduire.
                </div>

                <button type="submit">Calculer le taux d'alcool√©mie</button>
            </form>

            <div id="result" class="result" style="display: none;">
                <div class="bac-display">
                    <div class="bac-value" id="bacValue">0.00<span class="bac-unit">‚Ä∞</span></div>
                    <div class="bac-status" id="bacStatus">√Ä jeun</div>
                </div>
                <div class="result-summary" id="resultSummary"></div>
                <div class="sobriety-timeline" id="sobrietyTimeline"></div>
            </div>
        </div>

        <div class="info-cards-container">
            <div class="info-step-card highlight">
                <div class="step-icon"><i class="fas fa-gavel"></i></div>
                <div class="step-content">
                    <h3>Limites d'alcool√©mie en Suisse</h3>
                    <div class="legal-limit-card standard">
                        <div class="legal-limit-value">0.5‚Ä∞</div>
                        <div><strong>Conducteurs normaux</strong><br><small>Avec permis d√©finitif</small></div>
                    </div>
                    <div class="legal-limit-card strict">
                        <div class="legal-limit-value">0.1‚Ä∞</div>
                        <div><strong>Nouveaux conducteurs & professionnels</strong><br><small>Tol√©rance z√©ro</small></div>
                    </div>
                </div>
            </div>
            <div class="info-step-card">
                <div class="step-icon"><i class="fas fa-hourglass-half"></i></div>
                <div class="step-content">
                    <h3>√âlimination de l'alcool</h3>
                    <p>Le corps √©limine l'alcool √† raison d'environ <strong>0.1 ‚Äì 0.15‚Ä∞ par heure</strong>.</p>
                    <p>Cette √©limination est constante et ne peut pas √™tre acc√©l√©r√©e.</p>
                </div>
            </div>
            <div class="info-step-card" style="grid-column: 1 / -1;">
                <div class="step-icon"><i class="fas fa-globe-europe"></i></div>
                <div class="step-content">
                    <h3>Limites d'alcool√©mie dans les pays voisins</h3>
                    <p style="margin-bottom: 1rem;">Limites diff√©rentes en conduisant √† l'√©tranger :</p>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem; min-width: 400px;">
                            <thead>
                                <tr style="border-bottom: 2px solid var(--border-color); text-align: left;">
                                    <th style="padding: 0.5rem;">Pays</th>
                                    <th style="padding: 0.5rem; text-align: center;">Normal</th>
                                    <th style="padding: 0.5rem; text-align: center;">Jeune conducteur</th>
                                    <th style="padding: 0.5rem; text-align: center;">Professionnel</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 0.5rem;">üá®üá≠ Suisse</td>
                                    <td style="padding: 0.5rem; text-align: center; font-weight: 600;">0.5‚Ä∞</td>
                                    <td style="padding: 0.5rem; text-align: center; color: #dc3545;">0.1‚Ä∞</td>
                                    <td style="padding: 0.5rem; text-align: center; color: #dc3545;">0.1‚Ä∞</td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 0.5rem;">üá©üá™ Allemagne</td>
                                    <td style="padding: 0.5rem; text-align: center; font-weight: 600;">0.5‚Ä∞</td>
                                    <td style="padding: 0.5rem; text-align: center; color: #dc3545;">0.0‚Ä∞</td>
                                    <td style="padding: 0.5rem; text-align: center; color: #dc3545;">0.0‚Ä∞</td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 0.5rem;">üá¶üáπ Autriche</td>
                                    <td style="padding: 0.5rem; text-align: center; font-weight: 600;">0.5‚Ä∞</td>
                                    <td style="padding: 0.5rem; text-align: center; color: #dc3545;">0.1‚Ä∞</td>
                                    <td style="padding: 0.5rem; text-align: center; color: #dc3545;">0.1‚Ä∞</td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 0.5rem;">üá´üá∑ France</td>
                                    <td style="padding: 0.5rem; text-align: center; font-weight: 600;">0.5‚Ä∞</td>
                                    <td style="padding: 0.5rem; text-align: center; color: #dc3545;">0.2‚Ä∞</td>
                                    <td style="padding: 0.5rem; text-align: center; color: #dc3545;">0.2‚Ä∞</td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 0.5rem;">üáÆüáπ Italie</td>
                                    <td style="padding: 0.5rem; text-align: center; font-weight: 600;">0.5‚Ä∞</td>
                                    <td style="padding: 0.5rem; text-align: center; color: #dc3545;">0.0‚Ä∞</td>
                                    <td style="padding: 0.5rem; text-align: center; color: #dc3545;">0.0‚Ä∞</td>
                                </tr>
                                <tr>
                                    <td style="padding: 0.5rem;">üá±üáÆ Liechtenstein</td>
                                    <td style="padding: 0.5rem; text-align: center; font-weight: 600; color: #28a745;">0.8‚Ä∞</td>
                                    <td style="padding: 0.5rem; text-align: center; color: #dc3545;">0.1‚Ä∞</td>
                                    <td style="padding: 0.5rem; text-align: center; color: #dc3545;">0.1‚Ä∞</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <p style="font-size: 0.8rem; margin-top: 0.75rem; opacity: 0.8;"><i class="fas fa-info-circle"></i> Jeune conducteur : pendant les 2-3 premi√®res ann√©es apr√®s l'obtention du permis.</p>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon"><i class="fas fa-calculator"></i></div>
                <div class="step-content">
                    <h3>Formule de Watson</h3>
                    <p>Le calcul est bas√© sur la <strong>formule de Watson</strong> (1981), qui calcule l'eau corporelle totale :</p>
                    <p><strong>TAC = A √∑ (0.8 √ó TBW)</strong></p>
                    <p><small>TBW (Total Body Water) est calcul√© √† partir du sexe, du poids, de la taille et de l'√¢ge ‚Äì la m√©thode la plus pr√©cise disponible.</small></p>
                </div>
            </div>

            <div class="info-step-card" style="border-left: 4px solid #dc3545;">
                <div class="step-icon"><i class="fas fa-bicycle"></i></div>
                <div class="step-content">
                    <h3>Attention : aussi √† v√©lo !</h3>
                    <p>Il n'y a pas de limite l√©gale d'alcool√©mie pour le v√©lo ‚Äì mais : <strong>conduire un v√©lo en √©tat d'ivresse peut entra√Æner le retrait du permis de conduire auto !</strong></p>
                    <p><small>En cas de suspicion d'inaptitude √† la conduite, un examen m√©dico-l√©gal peut √™tre ordonn√©. Dans le pire des cas, vous risquez le retrait du permis ‚Äì m√™me si vous √©tiez √† v√©lo.</small></p>
                </div>
            </div>

            <div class="info-step-card" style="grid-column: 1 / -1;">
                <div class="step-icon"><i class="fas fa-hands-helping"></i></div>
                <div class="step-content">
                    <h3>Rentrer en s√©curit√©</h3>
                    <p style="margin-bottom: 1rem;">Ces organisations vous aident √† rentrer chez vous en toute s√©curit√© :</p>
                    <div style="display: flex; flex-wrap: wrap; gap: 1rem;">
                        <a href="https://www.nezrouge.ch/fr/" target="_blank" rel="noopener" style="flex: 1; min-width: 200px; padding: 1rem; background: var(--light-bg); border-radius: 8px; text-decoration: none; color: inherit; border: 1px solid var(--border-color);">
                            <strong style="color: #dc3545;">Nez Rouge</strong><br>
                            <small>Service de raccompagnement gratuit pendant les f√™tes (No√´l, Nouvel An). Des b√©n√©voles vous ram√®nent avec votre voiture.</small>
                        </a>
                        <a href="https://www.amsteuernie.ch/fr/" target="_blank" rel="noopener" style="flex: 1; min-width: 200px; padding: 1rem; background: var(--light-bg); border-radius: 8px; text-decoration: none; color: inherit; border: 1px solid var(--border-color);">
                            <strong style="color: var(--primary-color);">Am Steuer Nie</strong><br>
                            <small>Organisation de pr√©vention avec mat√©riel d'information, simulateurs et ateliers sur l'alcool, les drogues et la fatigue au volant.</small>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="law-section">
            <h2>Sanctions pour conduite en √©tat d'ivresse</h2>
            <p class="law-subtitle">Suisse ‚Äì Art. 91 LCR</p>
            <div class="law-card">
                <div class="law-header"><h3>0.5 ‚Äì 0.79‚Ä∞</h3></div>
                <div class="law-content"><p><strong>Avertissement</strong> et amende (d√®s CHF 600)</p></div>
            </div>
            <div class="law-card">
                <div class="law-header"><h3>0.8‚Ä∞ et plus</h3></div>
                <div class="law-content"><p><strong>Retrait du permis</strong> minimum 3 mois</p></div>
            </div>
            <div class="law-card">
                <div class="law-header"><h3>1.6‚Ä∞ et plus</h3></div>
                <div class="law-content">
                    <p><strong>Retrait du permis</strong> minimum 2 ans, examen m√©dical obligatoire</p>
                    <p><small style="color: #dc3545;"><i class="fas fa-flask"></i> Vous devez prouver votre abstinence pendant des mois avec des analyses de cheveux ‚Äì co√ªt : plusieurs milliers de francs.</small></p>
                </div>
            </div>

            <p style="text-align: center; margin-top: 1rem; font-size: 0.85rem; opacity: 0.8;">
                <i class="fas fa-chart-line"></i> En 2021, <strong>10'591 permis de conduire</strong> ont √©t√© retir√©s en Suisse pour cause d'alcool.
            </p>
        </div>

        <section class="seo-content">
            <h3>Questions fr√©quentes sur l'alcool√©mie</h3>
            <div class="faq-section">
                <details class="faq-item">
                    <summary>Combien de promilles apr√®s une bi√®re?</summary>
                    <p>Une bi√®re standard (300ml, 5%) contient environ 12g d'alcool. Pour un homme de 80kg, cela donne environ <strong>0.2‚Ä∞</strong>, pour une femme de 60kg environ <strong>0.35‚Ä∞</strong>.</p>
                </details>
                <details class="faq-item">
                    <summary>Quelle est la limite d'alcool√©mie en Suisse?</summary>
                    <p>La limite est de <strong>0.5‚Ä∞</strong>. Pour les nouveaux conducteurs (3 premi√®res ann√©es) et chauffeurs professionnels: <strong>0.1‚Ä∞</strong>.</p>
                </details>
                <details class="faq-item">
                    <summary>√Ä quelle vitesse le corps √©limine-t-il l'alcool?</summary>
                    <p>Environ <strong>0.1-0.15‚Ä∞ par heure</strong>. Cette √©limination ne peut √™tre acc√©l√©r√©e.</p>
                </details>
            </div>
        </section>
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <p><a href="https://durchblick.nl" target="_blank" rel="noopener">Durchblick Consultancy BV</a></p>
            <p class="footer-disclaimer">Ce calculateur est fourni √† titre indicatif et ne remplace pas une mesure d'alcool√©mie.</p>
            <p class="footer-privacy">Tous les calculs sont effectu√©s localement. Aucune donn√©e n'est enregistr√©e.</p>
        </div>
    </footer>

    <script>
        let state = { gender: 'male', weight: 75, height: 175, age: 30, drinks: { 'beer': 0, 'beer-large': 0, 'wine': 0, 'wine-glass': 0, 'shot': 0, 'cocktail': 0 } };
        const drinkAlcohol = { 'beer': 12, 'beer-large': 20, 'wine': 9.6, 'wine-glass': 14.4, 'shot': 12.8, 'cocktail': 12.8 };

        // Watson formula (1981) - calculates Total Body Water
        // Source: Watson PE, Watson ID, Batt RD: "Total body water volumes for adult males
        // and females estimated from simple anthropometric measurements"
        // Am J Clin Nutr. 1980;33(1):27-39
        function calculateTBW(gender, weight, height, age) {
            if (gender === 'male') {
                return 2.447 - 0.09516 * age + 0.1074 * height + 0.3362 * weight;
            } else {
                return -2.097 + 0.1069 * height + 0.2466 * weight;
            }
        }

        function selectGender(gender) {
            state.gender = gender;
            document.querySelectorAll('.gender-btn').forEach(btn => btn.classList.toggle('active', btn.dataset.gender === gender));
            calculateBAC();
        }

        function updateWeight(value) {
            state.weight = parseInt(value);
            document.getElementById('weightValue').textContent = value + ' kg';
            calculateBAC();
        }

        function updateHeight(value) {
            state.height = parseInt(value);
            document.getElementById('heightValue').textContent = value + ' cm';
            calculateBAC();
        }

        function updateAge(value) {
            state.age = parseInt(value);
            document.getElementById('ageValue').textContent = value + ' ans';
            calculateBAC();
        }

        function changeDrink(drink, delta) {
            state.drinks[drink] = Math.max(0, state.drinks[drink] + delta);
            document.getElementById('count-' + drink).textContent = state.drinks[drink];
            const card = document.getElementById('drink-' + drink);
            card.classList.toggle('has-drinks', state.drinks[drink] > 0);
            const minusBtn = card.querySelector('button:first-of-type');
            minusBtn.disabled = state.drinks[drink] === 0;
            const totalDrinks = Object.values(state.drinks).reduce((a, b) => a + b, 0);
            document.getElementById('drinkWarning').style.display = totalDrinks > 0 ? 'block' : 'none';
            calculateBAC();
        }

        function calculateBAC() {
            let totalAlcohol = 0;
            for (const [drink, count] of Object.entries(state.drinks)) { totalAlcohol += drinkAlcohol[drink] * count; }
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;
            let hoursElapsed = 0;
            if (startTime && endTime) {
                const start = new Date(`2000-01-01T${startTime}`);
                let end = new Date(`2000-01-01T${endTime}`);
                if (end < start) end.setDate(end.getDate() + 1);
                hoursElapsed = (end - start) / (1000 * 60 * 60);
            }
            const tbw = calculateTBW(state.gender, state.weight, state.height, state.age);
            let bac = totalAlcohol / (tbw * 0.8);
            bac = Math.max(0, bac - (hoursElapsed * 0.15));
            return { bac, totalAlcohol, hoursElapsed };
        }

        function getStatusClass(bac) {
            if (bac < 0.3) return { class: 'safe', text: 'Probablement apte √† conduire' };
            if (bac < 0.5) return { class: 'caution', text: 'Attention ‚Äì proche de la limite' };
            if (bac < 0.8) return { class: 'danger', text: 'Inapte √† conduire !' };
            return { class: 'critical', text: 'Fortement alcoolis√© !' };
        }

        function formatTime(date) { return date.toLocaleTimeString('fr-CH', { hour: '2-digit', minute: '2-digit' }); }

        function displayResult(result) {
            const { bac, totalAlcohol, hoursElapsed } = result;
            const status = getStatusClass(bac);
            document.getElementById('bacValue').innerHTML = bac.toFixed(2) + '<span class="bac-unit">‚Ä∞</span>';
            document.getElementById('bacValue').className = 'bac-value bac-' + status.class;
            const statusEl = document.getElementById('bacStatus');
            statusEl.textContent = status.text;
            statusEl.className = 'bac-status ' + status.class;
            let summaryHTML = `<h3>R√©sum√©</h3><p><strong>Alcool total :</strong> ${totalAlcohol.toFixed(1)}g</p><p><strong>Taux estim√© :</strong> ${bac.toFixed(2)}‚Ä∞</p>`;
            if (bac >= 0.5) {
                const hoursTo05 = (bac - 0.5) / 0.15;
                const hoursTo0 = bac / 0.15;
                const now = new Date();
                const timeTo05 = new Date(now.getTime() + hoursTo05 * 60 * 60 * 1000);
                const timeTo0 = new Date(now.getTime() + hoursTo0 * 60 * 60 * 1000);
                summaryHTML += `<p><strong>Sous 0.5‚Ä∞ :</strong> env. ${formatTime(timeTo05)} (dans ${hoursTo05.toFixed(1)}h)</p><p><strong>Sobre :</strong> env. ${formatTime(timeTo0)} (dans ${hoursTo0.toFixed(1)}h)</p>`;
            } else if (bac > 0) {
                const hoursTo0 = bac / 0.15;
                const now = new Date();
                const timeTo0 = new Date(now.getTime() + hoursTo0 * 60 * 60 * 1000);
                summaryHTML += `<p><strong>Sobre :</strong> env. ${formatTime(timeTo0)} (dans ${hoursTo0.toFixed(1)}h)</p>`;
            }
            document.getElementById('resultSummary').innerHTML = summaryHTML;
            if (bac > 0) {
                let timelineHTML = '<h4>Pr√©vision d\'√©limination</h4>';
                const now = new Date();
                for (let h = 0; h <= 12; h++) {
                    const bacAtTime = Math.max(0, bac - (h * 0.15));
                    if (bacAtTime === 0 && h > 0) break;
                    const time = new Date(now.getTime() + h * 60 * 60 * 1000);
                    const bacStatus = getStatusClass(bacAtTime);
                    timelineHTML += `<div class="timeline-item"><span class="timeline-time">${formatTime(time)}</span><span class="timeline-bac bac-${bacStatus.class}">${bacAtTime.toFixed(2)}‚Ä∞</span><span class="timeline-note">${h === 0 ? 'Maintenant' : `+${h}h`}</span></div>`;
                }
                document.getElementById('sobrietyTimeline').innerHTML = timelineHTML;
                document.getElementById('sobrietyTimeline').style.display = 'block';
            } else {
                document.getElementById('sobrietyTimeline').style.display = 'none';
            }
            document.getElementById('result').style.display = 'block';
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        }

        document.getElementById('promilleForm').addEventListener('submit', function(e) { e.preventDefault(); displayResult(calculateBAC()); });
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            document.getElementById('endTime').value = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
        });

        const DarkMode = {
            STORAGE_KEY: 'darkMode',
            init() { const saved = localStorage.getItem(this.STORAGE_KEY); if (saved === 'true' || (saved === null && window.matchMedia('(prefers-color-scheme: dark)').matches)) this.enable(false); this.updateButton(); },
            enable(save = true) { document.documentElement.setAttribute('data-theme', 'dark'); if (save) localStorage.setItem(this.STORAGE_KEY, 'true'); this.updateButton(); },
            disable(save = true) { document.documentElement.removeAttribute('data-theme'); if (save) localStorage.setItem(this.STORAGE_KEY, 'false'); this.updateButton(); },
            toggle() { document.documentElement.getAttribute('data-theme') === 'dark' ? this.disable() : this.enable(); },
            updateButton() { const btn = document.querySelector('.dark-mode-toggle i'); if (btn) btn.className = document.documentElement.getAttribute('data-theme') === 'dark' ? 'fas fa-sun' : 'fas fa-moon'; }
        };
        DarkMode.init();
    </script>
</body>
</html>
